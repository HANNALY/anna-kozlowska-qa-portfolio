ğŸŸ¥ Bug Report â€“ 500 Internal Server Error w procesie MNP/Transfer (eSIM)

Severity: Critical
Priority: Blocker
Status: Reproducible
Åšrodowisko: TEST
ModuÅ‚: MNP / Transfer numeru
Komponent: msisdn-service

1ï¸âƒ£ Opis bÅ‚Ä™du

Podczas procesu MNP/Transfer numeru dla oferty Mobile + eSIM backend zwraca bÅ‚Ä…d 500 Internal Server Error przy wywoÅ‚aniu endpointu POST /msisdn/cases, co blokuje dalszy proces i uniemoÅ¼liwia dokoÅ„czenie zamÃ³wienia.

BÅ‚Ä…d w peÅ‚ni blokujÄ…cy proces biznesowy.

2ï¸âƒ£ Request â€“ utworzenie koszyka (curl)
curl -X 'POST' \
  'https://sklep-test.play.pl/api/cart/' \
  -H 'accept: */*' \
  -H 'Content-Type: application/json' \
  -d '{
    "cartItems": [
      {
        "itemType": "SOLO",
        "offerItems": [
          {
            "offerId": 4025680619,
            "offerType": "MOBILE",
            "simType": "ESIM"
          }
        ]
      }
    ]
  }'


OrderId: f7b3fc64-ed64-403d-950a-7c6166f1f3d7
Oferta: MNP â†’ Mobile â†’ eSIM

Payload generowany poprawnie po stronie koszyka â€“ bÅ‚Ä…d pojawia siÄ™ w backendzie.

3ï¸âƒ£ OdpowiedÅº z bÅ‚Ä™dem (response)
{
  "errorUuid": "db8765d6-450c-471b-96fe-3156d06a4b9d",
  "reasons": [
    "InternalException: 500 Internal Server Error from POST http://msisdn-service.neweshop-test.svc.cluster.local:8080/msisdn/cases"
  ]
}

4ï¸âƒ£ Oczekiwany rezultat

System poprawnie tworzy case MNP w msisdn-service, umoÅ¼liwiajÄ…c przejÅ›cie do kolejnego kroku aktywacji eSIM.

5ï¸âƒ£ Rzeczywisty rezultat

Backend zwraca HTTP 500 â†’ proces zostaje przerwany â†’ zamÃ³wienia MNP/eSIM nie moÅ¼na dokoÅ„czyÄ‡.

6ï¸âƒ£ Analiza logÃ³w (Kibana â€“ skrÃ³t)

ğŸŸ¦ Tu moÅ¼esz wkleiÄ‡ logi, jeÅ›li chcesz â€” mogÄ™ je teÅ¼ sformatowaÄ‡.

PrzykÅ‚adowy zapis:

InternalException at msisdn-service:
java.lang.NullPointerException: Cannot create MNP case
Request payload valid â†’ failure on service call â†’ msisdn-case creation aborted.

7ï¸âƒ£ Klasyfikacja bÅ‚Ä™du

Severity: Critical â€“ bÅ‚Ä…d backendu

Priority: Blocker â€“ blokuje proces biznesowy

Typ bÅ‚Ä™du: Backend exception / integration failure

Status: Reproducible

8ï¸âƒ£ Impact na proces biznesowy

âŒ brak moÅ¼liwoÅ›ci wykonania transferu numeru (MNP)
âŒ brak moÅ¼liwoÅ›ci finalizacji zamÃ³wienia eSIM
âŒ niedziaÅ‚ajÄ…ca integracja z msisdn-service
âŒ ryzyko zatrzymania sprzedaÅ¼y dla caÅ‚ego wariantu oferty

9ï¸âƒ£ Propozycja fixu

âœ” walidacja danych wejÅ›ciowych przed wywoÅ‚aniem POST /msisdn/cases
âœ” obsÅ‚uga bÅ‚Ä™dÃ³w po stronie msisdn-service (null safety)
âœ” dodanie logÃ³w debug dla procesu tworzenia case
âœ” testy integracyjne na trasie: cart-service â†’ msisdn-service
